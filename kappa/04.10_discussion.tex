\section{Discussion}
The main result in this thesis are discussed below with respect to the main objective to develop system identification methods for grey box models of ship rigid body dynamics in calm waters.

\subsubsection*{Roll model}
The objective was used to identify the parameters in the linear (Eq.\ref{eq:roll_decay_equation_himeno_linear}), quadratic (Eq.\ref{eq:roll_decay_equation_himeno_quadratic_b}) and cubic (Eq.\ref{eq:roll_decay_equation_cubic}) roll motion model for the 250 roll decay tests obtained from SSPA. 
The accuracy of the linear model was not as good as the more complex models. The quadratic model had almost as high accuracy as the cubic model. The quadratic model, which is more robust, is therefore the best choice to describe the roll motion. Increasing the complexity from the one degree of freedom roll motion parameter estimation, parameter estimation for surge, sway and yaw was investigated as described in the next section.

\subsubsection*{Manoeuvring model}
It is shown in both \ref{pap:daiyong} and Paper \ref{pap:pit} that the hydrodynamic derivatives within a manoeuvring model can be identified exactly at ideal conditions with no measurement noise and a perfect estimator. 
This type of result can be seen when identifying parameters in a manoeuvring model on data from simulations with the same manoeuvring model.
In order to succeed in system identification on actual model test data, measurement noise as well as model uncertainty need to be handled, and a manoeuvring model as close as possible to the real system needs to be found. The proposed parameter estimation method requires that the model test data is preprocessed to remove measurement noise. The method uses iterative EKF and RTS smoothers as the preprocessor. This preprocessor has higher accuracy and avoids finding the optimal cut-off frequency compared to low-pass filters. 

The linearization in the EKF can cause stability problems. This can be a problem for sparse time series, with longer time steps. This was however not a problem for the present test cases, with very high frequency data (100 Hz). 
Using Unscented Kalman Filter (UKF) instead of EKF is a possible solution, if these kinds of stability problems occur. This has however not been further investigated in this thesis.

Multicollinearity was a significant problem with the AVMM for both the wPCC and KVLCC2 data. Consequently, some of the regressed hydrodynamic derivatives in the AVMM have unphysically large values and substantial uncertainties. The model is still mathematically correct, where the regressed polynomials fit the training data well. The regressed polynomial is the sum of large counteracting coefficients. The model works as long as the states are similar to the training data. However, when extrapolating, it is easy to imagine that the balance between these massive derivatives is disturbed, giving significant extrapolation errors very quickly. This behavior was seen when predicting forces and moments with the AVMM on unseen validation data and is a well known problem \cite{ittc_maneuvering_2008}.
The MAVMM has fewer hydrodynamic derivatives with lower multicollinearity and minor extrapolation errors. Including propeller thrust in the manoeuvring model made it possible to obtain high accuracy with fewer hydrodynamic derivatives. Another problem with a too complex model is that the standard manoeuvres used in this paper does not follow the aspect of persistence of excitation, so that some of the hydrodynamic derivatives might not be identifiable \cite{revestido_herrero_two-step_2012}. During zigzag tests, the model is for instance exposed to only two rudder angles for a majority of the data. A series of step responses as used in \cite{miller_ship_2021} gives a better excitation, but requires a lot of space, which is possible at lake experiments, but not in a narrow basin. The model generalization therefore needs to be addressed, as seen in the next section.

\subsubsection*{Model generalization} 
A model development process (\autoref{sec:model_development_process}) for manoeuvring models with good generalization was proposed in Paper \ref{pap:pit}.
The process was applied together with the proposed parameter estimation technique on the wPCC and KVLCC2 test cases. Turning circles where predicted with good accuracy on models trained on zigzag tests. This shows that the models have good generalization, since the turning circles have much larger rudder angles, drift angles and yaw rates, compared to the training zigzag tests. 

\subsubsection*{Other findings}
The  ''integration approach'' produced better models than the ''derivation approach'' for the roll motion models in Paper \ref{pap:rolldamping}. The ''integration approach'' is very slow and relies on optimization that may or may not converge.
The numerical differentiation that was used in Paper \ref{pap:rolldamping} to estimate the velocities and accelerations, is believed to be the main cause of the poor performance of the much faster and more reliable ''derivation approach''. A similar issue was also encountered in Paper \ref{pap:daiyong}, where the identified hydrodynamic derivatives were very sensitive to the choice of the regularisation factor of the LS-SVR.
The iterative EKF + RTS smoother proposed in Paper \ref{pap:pit} has reduced these issues. It is also shown that the proposed way to handle noise is better than low-pass filters.
